\newlength{\TempFigureLength}

\newenvironment{FigureEnvironment}{
  \begin{figure}[!t]%
  \begin{center}%
  \vskip 5mm%
}{
  \end{center}%
  \end{figure}%
}

\def\FigureSize{0.8}

\newcommand{\Figure}[3][scale=\FigureSize]{%
  \begin{FigureEnvironment}%
    \refstepcounter{figure}%
    \addcontentsline{lof}{section}{Fig.~\thefigure{}~~~{#2}}%
    \label{fig:#3}%
    \includegraphics[#1]{figures/#3}\\[1em]%
    \small%
    \settowidth{\TempFigureLength}{Fig.~\thefigure{}.~~{#2}}%
    \ifdim \TempFigureLength > 0.95\columnwidth%
      \parbox{0.95\columnwidth}{Fig.~\thefigure{}.~~{#2}}%
    \else%
      Fig.~\thefigure{}.~~{#2}%
    \fi%
  \end{FigureEnvironment}%
}

\newcommand{\Plot}[2]{%
  \begin{FigureEnvironment}%
    \refstepcounter{figure}%
    \addcontentsline{lof}{section}{Fig.~\thefigure{}~~~{#1}}%
    \label{fig:#2}%
    \begin{tikzpicture}[trim axis left, trim axis right]
    \input{figures/#2}
    \end{tikzpicture}\par
    \small%
    \settowidth{\TempFigureLength}{Fig.~\thefigure{}.~~{#1}}%
    \ifdim \TempFigureLength > 0.95\columnwidth%
      \parbox{0.95\columnwidth}{Fig.~\thefigure{}.~~{#1}}%
    \else%
      Fig.~\thefigure{}.~~{#1}%
    \fi%
  \end{FigureEnvironment}%
}
